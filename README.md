# üß© Home-Work-64: –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–µ—Ä–≤–µ—Ä–∞ Express –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º Passport –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó

## üìñ –û–ø–∏—Å –ø—Ä–æ—î–∫—Ç—É

–¶–µ–π –ø—Ä–æ—î–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è **Node.js** —Ç–∞ **Express.js** —Ä–∞–∑–æ–º —ñ–∑ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–æ—é **Passport.js** –¥–ª—è —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –±–µ–∑–ø–µ—á–Ω–æ—ó –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.  
–†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –ª–æ–∫–∞–ª—å–Ω—É —Å—Ç—Ä–∞—Ç–µ–≥—ñ—é –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó (email + –ø–∞—Ä–æ–ª—å), —Å–µ—Å—ñ—ó, –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è cookies —Ç–∞ –∑–∞—Ö–∏—â–µ–Ω–∏–π –º–∞—Ä—à—Ä—É—Ç.

---

## ‚öôÔ∏è –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó
- **Node.js**
- **Express.js**
- **Passport.js**
- **passport-local**
- **express-session**
- **bcrypt** ‚Äî —Ö–µ—à—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—ñ–≤
- **EJS** ‚Äî —à–∞–±–ª–æ–Ω—ñ–∑–∞—Ç–æ—Ä –¥–ª—è —Ñ–æ—Ä–º –ª–æ–≥—ñ–Ω—É/—Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó
- **cookie-parser**, **body-parser**

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
home-work-64/
‚îÇ
‚îú‚îÄ app.js
‚îú‚îÄ package.json
‚îú‚îÄ config/
‚îÇ ‚îî‚îÄ passportConfig.js
‚îú‚îÄ routes/
‚îÇ ‚îú‚îÄ auth.js
‚îÇ ‚îî‚îÄ protected.js
‚îú‚îÄ views/
‚îÇ ‚îú‚îÄ register.ejs
‚îÇ ‚îú‚îÄ login.ejs
‚îÇ ‚îî‚îÄ protected.ejs
‚îî‚îÄ README.md


---

## üöÄ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –∑–∞–ø—É—Å–∫

1Ô∏è‚É£ –ö–ª–æ–Ω—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π:
git clone https://github.com/<your-username>/home-work-64.git
cd home-work-64

2Ô∏è‚É£ –í—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ:
npm install

3Ô∏è‚É£ –ó–∞–ø—É—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä:
npm start

(–∞–±–æ node app.js, —è–∫—â–æ –Ω–µ–º–∞—î npm-—Å–∫—Ä–∏–ø—Ç—É)

4Ô∏è‚É£ –í—ñ–¥–∫—Ä–∏–π —É –±—Ä–∞—É–∑–µ—Ä—ñ:
http://localhost:3000/register

‚úÖ –£ —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ –º–∞—î –∑‚Äô—è–≤–∏—Ç–∏—Å—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:

Server running on http://localhost:3000

-------------

üßæ –ú–∞—Ä—à—Ä—É—Ç–∏
–ú–µ—Ç–æ–¥    |      –®–ª—è—Ö	        |    –û–ø–∏—Å
GET	     |      /register	    |    –§–æ—Ä–º–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
POST	 |      /register	    |    –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–∑ —Ö–µ—à—É–≤–∞–Ω–Ω—è–º –ø–∞—Ä–æ–ª—è)
GET	     |      /login	        |    –§–æ—Ä–º–∞ –≤—Ö–æ–¥—É
POST	 |      /login	        |    –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —á–µ—Ä–µ–∑ Passport Local Strategy
GET    	 |      /protected	    |    –ó–∞—Ö–∏—â–µ–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞, –¥–æ—Å—Ç—É–ø–Ω–∞ –ª–∏—à–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º
GET	     |      /logout	        |    –í–∏—Ö—ñ–¥ —ñ–∑ —Å–∏—Å—Ç–µ–º–∏ —Ç–∞ –∑–Ω–∏—â–µ–Ω–Ω—è —Å–µ—Å—ñ—ó

-----------

üîí –õ–æ–≥—ñ–∫–∞ —Ä–æ–±–æ—Ç–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó
–ü—Ä–∏ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–≤–æ–¥–∏—Ç—å email —ñ –ø–∞—Ä–æ–ª—å.
‚Üí –ø–∞—Ä–æ–ª—å —Ö–µ—à—É—î—Ç—å—Å—è —á–µ—Ä–µ–∑ bcrypt
‚Üí –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è —É –ø–∞–º‚Äô—è—Ç—ñ (–º–æ–∂–Ω–∞ –∑–∞–º—ñ–Ω–∏—Ç–∏ –Ω–∞ –±–∞–∑—É –¥–∞–Ω–∏—Ö)

–ü—Ä–∏ –ª–æ–≥—ñ–Ω—ñ Passport Local Strategy:

—à—É–∫–∞—î –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑–∞ email;

–ø–æ—Ä—ñ–≤–Ω—é—î –ø–∞—Ä–æ–ª—å —ñ–∑ —Ö–µ—à–µ–º;

–ø—Ä–∏ —É—Å–ø—ñ—Ö—É —Å—Ç–≤–æ—Ä—é—î —Å–µ—Å—ñ—é.

express-session –∑–±–µ—Ä—ñ–≥–∞—î —Å–µ—Å—ñ—é —É cookie:

httpOnly: true ‚Äî cookie –Ω–µ –º–æ–∂–Ω–∞ —á–∏—Ç–∞—Ç–∏ –∑ JavaScript;

secure: false ‚Äî –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±–µ–∑ HTTPS (—É –ª–æ–∫–∞–ª—å–Ω—ñ–π —Ä–æ–∑—Ä–æ–±—Ü—ñ).

–ü—Ä–∏ –¥–æ—Å—Ç—É–ø—ñ –¥–æ /protected –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è middleware:

function checkAuthenticated(req, res, next) {
    if (req.isAuthenticated()) return next();
    res.redirect('/login');
}
‚Üí —Ç—ñ–ª—å–∫–∏ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –±–∞—á–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç —Å—Ç–æ—Ä—ñ–Ω–∫–∏.

------------------

üß† –Ø–∫ —à–≤–∏–¥–∫–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ä–æ–±–æ—Ç—É
üîπ 1. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
npm start
–∞–±–æ
node app.js

‚Üí –°–µ—Ä–≤–µ—Ä –ø—Ä–∞—Ü—é—î –Ω–∞ http://localhost:3000.

üîπ 2. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä—ñ
–ö—Ä–æ–∫	URL	–û—á—ñ–∫—É–≤–∞–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
1Ô∏è‚É£ –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è	/register	–ó–∞–ø–æ–≤–Ω—é—î—à —Ñ–æ—Ä–º—É, –ø–µ—Ä–µ—Ö–æ–¥–∏—à –Ω–∞ /login
2Ô∏è‚É£ –õ–æ–≥—ñ–Ω	/login	–ü—ñ—Å–ª—è –≤–≤–µ–¥–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö ‚Äî —Ä–µ–¥—ñ—Ä–µ–∫—Ç –Ω–∞ /protected
3Ô∏è‚É£ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞—Ö–∏—â–µ–Ω–æ–≥–æ –º–∞—Ä—à—Ä—É—Ç—É	/protected	–í–∏–≤–æ–¥–∏—Ç—å—Å—è ‚ÄúWelcome, test@example.com!‚Äù
4Ô∏è‚É£ –í–∏—Ö—ñ–¥	/logout	–ü–æ–≤–µ—Ä—Ç–∞—î –Ω–∞ /login, –¥–æ—Å—Ç—É–ø –¥–æ /protected –±–ª–æ–∫—É—î—Ç—å—Å—è

üîπ 3. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–µ—Ä–µ–∑ —Ç–µ—Ä–º—ñ–Ω–∞–ª (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)

curl http://localhost:3000/register
‚Üí –ü–æ–≤–µ—Ä–Ω–µ HTML —Ñ–æ—Ä–º—É —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó.

---------------

üß© –ü—Ä–∏–∫–ª–∞–¥ —Ä–æ–±–æ—Ç–∏ —É —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ
Server running on http://localhost:3000
GET /register 200
POST /register 302
GET /login 200
POST /login 302
GET /protected 200
GET /logout 302

--------------

‚ö†Ô∏è –¢–∏–ø–æ–≤—ñ –ø–æ–º–∏–ª–∫–∏ —Ç–∞ —Ä—ñ—à–µ–Ω–Ω—è
–ü–æ–º–∏–ª–∫–∞	–ü—Ä–∏—á–∏–Ω–∞	–†—ñ—à–µ–Ω–Ω—è
Missing script: "start"	–£ package.json –Ω–µ–º–∞—î "start"	–î–æ–¥–∞–π "start": "node app.js"
Error: Failed to serialize user into session	Passport –Ω–µ –º–æ–∂–µ –∑–±–µ—Ä–µ–≥—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞	–ü–µ—Ä–µ–≤—ñ—Ä serializeUser —ñ deserializeUser —É passportConfig.js
/protected –ø–µ—Ä–µ–∫–∏–¥–∞—î –Ω–∞ /login	–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π	–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Å—è, —â–æ –≤–∏–∫–æ–Ω—É—î—à –ª–æ–≥—ñ–Ω —ñ —Å–µ—Å—ñ—è –∑–±–µ—Ä–µ–∂–µ–Ω–∞
bcrypt –ø–æ–º–∏–ª–∫–∞	–ù–µ—Å—É–º—ñ—Å–Ω–∞ –≤–µ—Ä—Å—ñ—è –∞–±–æ –≤—ñ–¥—Å—É—Ç–Ω—ñ–π –ø–∞–∫–µ—Ç	–ü–µ—Ä–µ–≤—Å—Ç–∞–Ω–æ–≤–∏ bcrypt: npm i bcrypt
